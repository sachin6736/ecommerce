<%- include('header',{admin:admin}) %>
<style>
    *{
    font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
}


.container {
    width: 100%;
    padding: 20px;
    background-color: #ffffff7c;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    
}

.customer_title {
    font-size: 24px;
    margin-bottom: 20px;
    color: #343a40;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
}

.btn-view-customers {
    width: 100px;
    background-color: #28a746;
    color: rgb(0, 0, 0);
    border: none;
    border-radius: 5px;
    text-align: center;
    /* padding: 10px 20px; */
    cursor: pointer;
    transition: background-color 0.3s, transform 0.3s;
}

.btn-view-customers:hover {
    background-color: #6bb87c;
    transform: scale(1.05);
}




.table {
    width: 100%;
    margin-top: 20px;
    border-collapse: collapse;
    background-color: #ffff;
    border-radius: 10px 10px 10px 10px;
}

.table th,
.table td {
    padding: 10px;
    text-align: left;
    border-bottom: 1px solid #ddd;
}

.table  th {
    background: linear-gradient(135deg, #d3d3d3, #a9a9a9); /* Changed to lightgray and darkgray */
    color: white;
}

.table tbody tr:nth-child(odd) {
    background-color: #f2f2f2;
}

.action-buttons {
    display: flex;
    gap: 5px;
}

.action-buttons button {
    background-color: #84919e;
    color: white;
    border: none;
    border-radius: 5px;
    padding: 5px 10px;
    cursor: pointer;
    transition: background-color 0.3s, transform 0.3s;
}

.action-buttons button:hover {
    background-color: #0056b3;
    transform: scale(1.05);
}

#block:hover
{
    background-color: #af0606;
    transform: scale(1.05);
}

</style>
<div class="container">
    <h2 class="customer_title">Customer Management</h2>
    <div class="search-bar">
       
    </div>  
        <table class="table">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="customerTableBody">
                <tr>
             <% customers.forEach(customer => {    %>
                <% let user_id = customer._id %>
                <td> <%=customer.firstname%> <%=customer.lastname%></td>
                <td><%=customer.email%></td>
                <td class="action-buttons">        
             <% if (customer.blocked) { %>
             <button style="background-color: rgb(207, 6, 6);"  onclick="unblock_user('<%=customer._id%>')"  id="block">Unblock</button>                       
             <% } else { %>
             <button  onclick="Block_User('<%= customer._id %>')"  id="block">Block</button> 
                <% } %>              
                </td>
            </tr>               
           <% }) %>

            </tbody>
        </table>
    
</div>

<script>
    async function Block_User(customer_id)
    {
        console.log("start")
    let customerId =  customer_id
    const response = await fetch(`/block_user/${customerId}`)
    console.log("fetched data")
    const blocked = await response.json
    if(blocked)
    {
        window.location.href='/customers'
    }
        
    }

   async function unblock_user(customerid){
   const customer_id = customerid
   console.log("start")
   const response = await fetch(`/unblock_user/${customer_id}`)
   console.log("data fetched")
   const unblockuser =await response.json
   console.log(unblockuser)
   if(unblockuser)
   {
    window.location.href='/customers'
   }


   } 
</script>

<%- include('footer') %>
